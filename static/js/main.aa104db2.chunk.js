(this["webpackJsonpeuro-predictions"]=this["webpackJsonpeuro-predictions"]||[]).push([[0],{26:function(e,t,n){},27:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var r,c,s=n(1),i=n.n(s),o=n(16),a=n.n(o),l=(n(26),n(20)),u=n(2),j=n(9),d=(n(27),n(17)),h=n(18);!function(e){e[e.HOME_WIN=0]="HOME_WIN",e[e.DRAW=1]="DRAW",e[e.AWAY_WIN=2]="AWAY_WIN"}(r||(r={})),function(e){e[e.CORRECT_SCORE=0]="CORRECT_SCORE",e[e.CORRECT_RESULT=1]="CORRECT_RESULT",e[e.INCORRECT_RESULT=2]="INCORRECT_RESULT",e[e.UNDETERMINED=3]="UNDETERMINED"}(c||(c={}));var O=function e(){var t=this;Object(h.a)(this,e),this.determineResult=function(e){var t=e.split("-")[0],n=e.split("-")[1];return t==n?r.DRAW:t>n?r.HOME_WIN:r.AWAY_WIN},this.determinePredictionResult=function(e,n){return n?e==n?c.CORRECT_SCORE:t.determineResult(e)===t.determineResult(n)?c.CORRECT_RESULT:c.INCORRECT_RESULT:c.UNDETERMINED},this.determinePointsForGame=function(e,n){switch(t.determinePredictionResult(e,n)){case c.CORRECT_SCORE:return 3;case c.CORRECT_RESULT:return 1;case c.INCORRECT_RESULT:case c.UNDETERMINED:default:return 0}},this.determinePoints=function(e){return e.players.map((function(n,r){return{player:n,score:e.games.map((function(e){return t.determinePointsForGame(e.predictions[r],e.result)})).reduce((function(e,t){return e+t}),0)}}))}},b=n(0),m=function(e){var t=e.players;return Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{children:"Match"}),Object(b.jsx)("th",{children:"Time"}),Object(b.jsx)("th",{children:"Team 1"}),Object(b.jsx)("th",{children:"Team 2"}),Object(b.jsx)("th",{children:"Result"}),t.map((function(e){return Object(b.jsx)("th",{children:e},e)}))]})})},R=n(19),p=function(e){var t=e.game,n=function(e,t){switch((new O).determinePredictionResult(e,t)){case c.CORRECT_SCORE:return"correct-score";case c.CORRECT_RESULT:return"correct-result";case c.INCORRECT_RESULT:return"incorrect-result";case c.UNDETERMINED:return""}};return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("td",{children:t.description}),Object(b.jsx)("td",{children:t.time}),Object(b.jsx)("td",{children:t.teamA}),Object(b.jsx)("td",{children:t.teamB}),Object(b.jsx)("td",{children:t.result}),t.predictions.map((function(e,r){return Object(b.jsx)("td",{className:n(e,t.result),children:e},r)}))]})},f=function(e){var t=e.results,n=Object(R.groupBy)(t.games,(function(e){return e.stage}));return Object(b.jsx)("div",{className:"table-wrapper",children:Object.entries(n).map((function(e){var n=e[0],r=e[1],c=r.some((function(e){return e.result})),s=r.every((function(e){return e.result}));return Object(b.jsxs)("details",{open:c&&!s,children:[Object(b.jsx)("summary",{children:n}),Object(b.jsxs)("table",{className:"results-table",children:[Object(b.jsx)(m,{players:t.players}),Object(b.jsx)("tbody",{children:r.map((function(e,t){return Object(b.jsx)("tr",{children:Object(b.jsx)(p,{game:e})},t)}))})]})]},n)}))})},E=function(e){var t=e.scores.sort((function(e,t){return e.score-t.score})).reverse();return Object(b.jsxs)("div",{className:"score-table",children:[Object(b.jsx)("div",{className:"table-header",children:Object(b.jsx)("div",{className:"table-entry",children:"Scores"})}),t.map((function(e){return Object(b.jsxs)("div",{className:"table-row",children:[Object(b.jsx)("div",{className:"table-entry",children:e.player}),Object(b.jsx)("div",{className:"table-entry",children:e.score})]},e.player)}))]})},g=function(e){var t=e.results,n=(new O).determinePoints(t);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(E,{scores:n}),Object(b.jsx)(f,{results:t})]})},x=function(){var e=Object(s.useState)(),t=Object(j.a)(e,2),n=t[0],r=t[1],c=Object(s.useState)(localStorage.getItem("token")||""),i=Object(j.a)(c,2),o=i[0],a=i[1],l=Object(s.useState)(!!localStorage.getItem("token")),u=Object(j.a)(l,2),h=u[0],O=u[1];Object(s.useEffect)((function(){o&&function(e){var t="https://sheets.googleapis.com/v4/spreadsheets/".concat("1TSSfGF2fWCKnjg1dIV7eUcnQwPlgncJl6WURdyd40pM","/values/Sheet1!A1:K100");return fetch("".concat(t,"?access_token=").concat(e)).then((function(e){if(!e.ok)throw new Error("Token expired");return e.json()})).then((function(e){var t;return{players:(t=e).values[0].slice(5),games:t.values.slice(1).filter((function(e){return e.length>=4})).map((function(e){var t=e[0].split("-"),n=t[0];return{stage:2===t.length?t[1]:t[0],description:n,time:e[1],teamA:e[2],teamB:e[3],result:e[4],predictions:e.slice(5)}}))}}))}(o).then((function(e){r(e)})).catch((function(){a(""),O(!1),localStorage.removeItem("token"),console.warn("Issue loading results, logging you out")}))}),[o]);var m="".concat("109764536947-mh2j0gmud5sg3dvpko3q9f8tsutr5tks.apps.googleusercontent.com");return Object(b.jsx)("div",{className:"App",children:n&&h?Object(b.jsx)(g,{results:n}):Object(b.jsx)("div",{className:"login-wrapper",children:Object(b.jsx)(d.GoogleLogin,{clientId:m,buttonText:"Login",onSuccess:function(e){var t=e;t&&(localStorage.setItem("token",t.accessToken),a(t.accessToken),O(!0))},onFailure:function(e){O(!1)},cookiePolicy:"single_host_origin",scope:"https://www.googleapis.com/auth/spreadsheets.readonly"})})})},T=function(){var e=sessionStorage.redirect;return delete sessionStorage.redirect,e&&e!=location.href&&history.replaceState(null,"euro-predictions",e),Object(b.jsx)(l.a,{basename:"euro-predictions",children:Object(b.jsx)("div",{children:Object(b.jsx)(u.c,{children:Object(b.jsx)(u.a,{path:"/",children:Object(b.jsx)(x,{})})})})})},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,35)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),s(e),i(e)}))};a.a.render(Object(b.jsx)(i.a.StrictMode,{children:Object(b.jsx)(T,{})}),document.getElementById("root")),C()}},[[34,1,2]]]);
//# sourceMappingURL=main.aa104db2.chunk.js.map