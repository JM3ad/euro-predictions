{"version":3,"sources":["app/service/score-service.ts","app/components/results-headers.tsx","app/components/results.tsx","app/components/score-display.tsx","app/components/predictions-display.tsx","app/pages/predictions.tsx","app/service/google-sheets-service.ts","app/App.tsx","app/reportWebVitals.ts","index.tsx"],"names":["GameResult","PredictionResult","ScoreService","determineResult","prediction","homeScore","split","awayScore","DRAW","HOME_WIN","AWAY_WIN","determinePredictionResult","result","CORRECT_SCORE","CORRECT_RESULT","INCORRECT_RESULT","UNDETERMINED","determinePointsForGame","determinePoints","results","players","map","player","index","score","games","game","predictions","reduce","sum","current","ResultsHeaders","props","playerName","GameRow","getPredictionClassName","description","time","teamA","teamB","entry","className","AllResults","gamesGroupedByStage","groupBy","stage","Object","entries","aGameHasBeenPlayed","some","allGamesHaveBeenPlayed","every","open","outerIndex","ScoreDisplay","orderedScores","scores","sort","a","b","reverse","PredictionsDisplay","PredictionsPage","useState","setResults","localStorage","getItem","token","setToken","loggedIn","setLoggedIn","useEffect","sheetsUrl","process","fetch","then","ok","Error","json","sheet","values","slice","filter","row","length","roundDescription","fetchResults","catch","removeItem","console","warn","clientId","buttonText","onSuccess","res","setItem","accessToken","onFailure","error","cookiePolicy","scope","App","redirect","sessionStorage","location","href","history","replaceState","basename","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.aa104db2.chunk.js","sourcesContent":["import { Results } from \"app/models/Results\";\nimport { Score } from \"app/models/Score\";\n\nenum GameResult {\n    HOME_WIN,\n    DRAW,\n    AWAY_WIN\n}\n\nexport enum PredictionResult {\n    CORRECT_SCORE,\n    CORRECT_RESULT,\n    INCORRECT_RESULT,\n    UNDETERMINED\n}\n\nclass ScoreService {\n    determineResult = (prediction: string): GameResult => {\n        const homeScore = prediction.split('-')[0];\n        const awayScore = prediction.split('-')[1];\n        if (homeScore == awayScore) {\n            return GameResult.DRAW;\n        }\n        if (homeScore > awayScore) {\n            return GameResult.HOME_WIN;\n        }\n        return GameResult.AWAY_WIN;\n    }\n\n    determinePredictionResult = (prediction: string, result: string): PredictionResult => {\n        if (!result) {\n            return PredictionResult.UNDETERMINED;\n        }\n        if (prediction == result) {\n            return PredictionResult.CORRECT_SCORE;\n        }\n        if (this.determineResult(prediction) === this.determineResult(result)){\n            return PredictionResult.CORRECT_RESULT;\n        }\n        return PredictionResult.INCORRECT_RESULT;\n    }\n\n    determinePointsForGame = (prediction: string, result: string): number => {\n        const predictionResult = this.determinePredictionResult(prediction, result);\n        switch(predictionResult) {\n            case PredictionResult.CORRECT_SCORE:\n                return 3;\n            case PredictionResult.CORRECT_RESULT:\n                return 1;\n            case PredictionResult.INCORRECT_RESULT:\n            case PredictionResult.UNDETERMINED:\n            default:\n                return 0;\n        }\n    };\n\n    determinePoints = (results: Results): Score[] => {\n        const scores = results.players.map((player, index) => {\n            const score = results.games.map((game) => {\n                const points = this.determinePointsForGame(game.predictions[index], game.result);\n                return points;\n            }).reduce((sum, current) => sum + current, 0);\n            return {\n                player: player,\n                score: score\n            };\n        });\n        return scores;\n    };\n}\n\nexport default ScoreService;","import React from 'react';\n\nexport type ResultsProps = {\n    players: string[];\n}\n\nconst ResultsHeaders: React.FC<ResultsProps> = (props: ResultsProps) => {\n    const players = props.players;\n    return <thead>\n    <tr>\n      <th>Match</th>\n      <th>Time</th>\n      <th>Team 1</th>\n      <th>Team 2</th>\n      <th>Result</th>\n      {\n        players.map((playerName) => {\n          return <th key={playerName}>{playerName}</th>;\n        })\n      }\n    </tr>\n  </thead>;\n}\n\nexport default ResultsHeaders;","import React from 'react';\nimport ScoreService, { PredictionResult } from 'app/service/score-service';\nimport ResultsHeaders from './results-headers';\nimport { Results } from 'app/models/Results';\nimport { Game } from 'app/models/Game';\nimport { groupBy } from 'lodash';\n\nexport type ResultsProps = {\n    results: Results;\n}\n\ntype GameRowProps = {\n  game: Game;\n};\n\nconst GameRow: React.FC<GameRowProps> = (props: GameRowProps) => {\n  const game = props.game;\n  const getPredictionClassName = (prediction: string, result: string) => {\n    const scoreService = new ScoreService();\n    const predictionResult = scoreService.determinePredictionResult(prediction, result);\n    switch(predictionResult) {\n      case PredictionResult.CORRECT_SCORE:\n        return \"correct-score\";\n      case PredictionResult.CORRECT_RESULT:\n        return \"correct-result\";\n      case PredictionResult.INCORRECT_RESULT:\n        return \"incorrect-result\";\n      case PredictionResult.UNDETERMINED:\n        return \"\";\n    }\n  }\n  return <>\n    <td>{game.description}</td>\n    <td>{game.time}</td>\n    <td>{game.teamA}</td>\n    <td>{game.teamB}</td>\n    <td>{game.result}</td>\n    {game.predictions.map((entry, index) => {\n      return <td key={index} className={getPredictionClassName(entry, game.result)}>\n        {entry}\n      </td>;\n    })}\n  </>;\n};\n\nconst AllResults: React.FC<ResultsProps> = (props: {results: Results}) => {\n    const results = props.results;\n    const gamesGroupedByStage = groupBy(results.games, (game: Game) => game.stage);\n\n    return <div className=\"table-wrapper\">\n      {\n        Object.entries(gamesGroupedByStage).map((entry: [stage: string, games: Game[]]) => {\n          const stage = entry[0];\n          const games = entry[1];\n          const aGameHasBeenPlayed = games.some((game) => game.result);\n          const allGamesHaveBeenPlayed = games.every((game) => game.result);\n\n          return <details key={stage} open={aGameHasBeenPlayed && !allGamesHaveBeenPlayed}>\n            <summary>{stage}</summary>\n            <table className=\"results-table\">\n              <ResultsHeaders players={results.players}/>\n              <tbody>\n                {games.map((game, outerIndex) => {\n                  return <tr key={outerIndex}>\n                    <GameRow game={game} />\n                  </tr>\n                })}\n              </tbody>\n            </table>\n          </details>\n        })\n      }\n    </div>;\n  };\n  \nexport default AllResults;  ","import { Score } from 'app/models/Score';\nimport React from 'react';\n\nexport type ScoreProps = {\n    scores: Score[];\n};\n\nconst ScoreDisplay: React.FC<ScoreProps> = (props: ScoreProps) => {\n    const scores = props.scores;\n    const orderedScores = scores.sort((a, b) => a.score - b.score).reverse();\n    return <div className=\"score-table\">\n      <div className=\"table-header\">\n        <div className=\"table-entry\">Scores</div>\n      </div>\n      {orderedScores.map((score: Score) => {\n        return <div key={score.player} className=\"table-row\">\n          <div className=\"table-entry\">{score.player}</div>\n          <div className=\"table-entry\">{score.score}</div>\n        </div>;\n      })}\n    </div>\n}\n  \nexport default ScoreDisplay;","import React from 'react';\nimport ScoreService from 'app/service/score-service';\nimport AllResults from './results';\nimport ScoreDisplay from './score-display';\nimport { Results } from 'app/models/Results';\n\nexport type PredictionsProps = {\n    results: Results;\n}\n\nconst PredictionsDisplay: React.FC<PredictionsProps> = (props: PredictionsProps) => {\n    const results = props.results;\n    const scoreService = new ScoreService();\n    const scores = scoreService.determinePoints(results);\n  \n    return <>\n      <ScoreDisplay scores={scores} />\n      <AllResults results={results} />\n    </>;\n};\n\nexport default PredictionsDisplay;","import React, {useEffect, useState} from 'react';\nimport 'app/pages/Pages.css';\nimport { GoogleLogin, GoogleLoginResponse, GoogleLoginResponseOffline } from 'react-google-login';\nimport PredictionsDisplay from 'app/components/predictions-display';\nimport { fetchResults } from 'app/service/google-sheets-service';\nimport { Results } from 'app/models/Results';\n\nconst PredictionsPage: React.FC = () => {\n  const [results, setResults] = useState<Results>();\n  const [token, setToken] = useState<string>(localStorage.getItem(\"token\") || \"\");\n  const [loggedIn, setLoggedIn] = useState<boolean>(!!localStorage.getItem(\"token\"));\n\n  const successGoogle = (res: GoogleLoginResponse | GoogleLoginResponseOffline) => {\n    const result = res as GoogleLoginResponse;\n    if (!result) {\n      return;\n    }\n    localStorage.setItem(\"token\", result.accessToken);\n    setToken(result.accessToken);\n    setLoggedIn(true);\n  };\n\n  const logOut = () => {\n    setToken(\"\");\n    setLoggedIn(false);\n    localStorage.removeItem(\"token\");\n  };\n\n  useEffect(() => {\n    if (token) {\n      fetchResults(token).then((results) => {\n        setResults(results)\n      }).catch(() => {\n        logOut();\n        console.warn(\"Issue loading results, logging you out\")\n      })\n    }\n  }, [token])\n\n  //eslint-disable-next-line\n  const failGoogle = (error: any) => {\n    setLoggedIn(false);\n  };\n  const clientId = `${process.env.REACT_APP_CLIENT_ID}`;\n\n  return (\n    <div className=\"App\">\n        {results && loggedIn\n          ? <PredictionsDisplay results={results} />\n          : <div className=\"login-wrapper\">\n            <GoogleLogin \n            clientId={clientId}\n            buttonText=\"Login\"\n            onSuccess={successGoogle}\n            onFailure={failGoogle}\n            cookiePolicy={'single_host_origin'}\n            scope={\"https://www.googleapis.com/auth/spreadsheets.readonly\"} />\n          </div>\n        }\n    </div>\n  );\n}\n\nexport default PredictionsPage;\n","import { Results } from \"app/models/Results\";\n\ninterface SheetsResult {\n    values: string[][];\n}\n\nconst getResultsFromSheet: (sheet: SheetsResult) => Results = (sheet: SheetsResult) => {\n    const players = sheet.values[0].slice(5);\n    const games = sheet.values.slice(1)\n      .filter((row) => row.length >= 4)\n      .map((row) => {\n      const roundDescription = row[0].split('-');\n      const description = roundDescription[0];\n      const stage = roundDescription.length === 2 ? roundDescription[1] : roundDescription[0];\n\n      const game = {\n        stage: stage,\n        description: description,\n        time: row[1],\n        teamA: row[2],\n        teamB: row[3],\n        result: row[4],\n        predictions: row.slice(5),\n      };\n      return game;\n    });\n    return {\n      players: players,\n      games: games\n    }\n};\n\nexport const fetchResults = (token: string): Promise<Results> => {\n    const sheetsUrl = `https://sheets.googleapis.com/v4/spreadsheets/${process.env.REACT_APP_SPREADSHEET_ID}/values/Sheet1!A1:K100`;\n    return fetch(`${sheetsUrl}?access_token=${token}`).then((result) => {\n        if (!result.ok) {\n          throw new Error(\"Token expired\"); \n        }\n        return result.json();\n      }).then((result) => {\n        const parsedResults = getResultsFromSheet(result);\n        return parsedResults;\n    });\n}","import React from 'react';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n} from \"react-router-dom\";\nimport PredictionsPage from 'app/pages/predictions';\n\nconst App: React.FC = () => {\n  const redirect = sessionStorage.redirect;\n  delete sessionStorage.redirect;\n  if (redirect && redirect != location.href) {\n    history.replaceState(null, process.env.REACT_APP_BASE_URL || '', redirect);\n  }\n\n  return (\n  <Router basename={process.env.REACT_APP_BASE_URL}>\n    <div>\n      <Switch>\n        <Route path=\"/\">\n          <PredictionsPage />\n        </Route>\n      </Switch>\n    </div>\n  </Router>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals: () => void = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'index.css';\nimport App from 'app/App';\nimport reportWebVitals from 'app/reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}